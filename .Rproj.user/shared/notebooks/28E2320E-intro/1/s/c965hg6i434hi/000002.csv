"0","w <- 0.25 # width of the uniform support set"
"0","m <- 5000 # length of chain"
"0","burn <- 1000 # burn in times"
"0","x <- numeric(m)"
"0","group <- c(125, 18, 20, 34)"
"0","prob <- function(y, group)"
"0","{ # compute the target density"
"0","  if(y < 0 || y >= 1)"
"0","    return(0)"
"0","  else"
"0","    return(((1/2 + y/4)^group[1])*(((1 - y) / 4)^group[2])*(((1 - y) / 4)^group[3])*((y / 4)^group[4]))"
"0","}"
"0","# generate the chain"
"0","u <- runif(m)"
"0","v <- runif(m, -w, w)"
"0","x[1] <- runif(1, -w, w)"
"0","for(i in 2:m)"
"0","{"
"0","  y <- x[i-1] + v[i]"
"0","  if(u[i] <= prob(y, group) / prob(x[i-1], group))"
"0","    x[i] <- y"
"0","  else"
"0","    x[i] <- x[i-1]"
"0","}"
"0","xb <- x[(burn+1):m]"
"0","print(mean(xb))"
"1","[1]"
"1"," 0.621647"
"1","
"
